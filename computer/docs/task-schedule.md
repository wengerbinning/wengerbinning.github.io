进程调度

在多任务操作系统中， 任务可以划分为两种模式：

* 非抢占式多任务(cooperative multitasking)
* 抢占式多任务(preemptive multitasking)

Linux提供了抢占式的多任务模式。

抢占(preemption)是指由调度程序来决定什么时候停止一个进程，以便其他进程能够得到执行机会。
进程的时间片(timeslice)实际上就是分配给每一个可运行进程的使用处理器的时间片段。



在非抢占式多任务模式下， 除非进程自己主动停止运行，否则它会一直执行。






在Linux中存在以下调度算法：

1. O(1)调度算法
2. RSDL调度算法

进程的调度策略
------------

进程可以分为IO密集型与CPU密集型。

IO密集型是指进程的大部分时间用来提交IO请求或等待IO - 经常长期处于可运行， 但是每次运行时间短，时间片需求小。
CPU密集型是指进程的大部分时间用来执行程序 - 降低调用频率，尽量多执行一段时间， 时间片需求大。




进程的优先级
----------

每一个进程存在一个优先级， 优先级高的进程先运行，优先级低的进程后运行。




Linux采用两种不同的优先级范围：（参考标准： POSIX.1b）

1. nice值:范围-20 ~ +19, 值越大，优先级越低，nice表示进程使用时间片的比例。 
2. 实时优先级: 范围 0 ~ 99, 值越大， 优先级越大。

Linux时间片未指定， 通过将使用处理器的比值来决定时间片， 则时间片与系统的负载相关。

Linux的调度类
------------

Linux调度类是描述每一个调度算法。

* 完全公平调度(CFS) - SCHED_NORMAL
* 先入先出的调度算法 - SCHED_FIFO
* 带有时间片的先入先出调度算法 - SCHED_RR

SCHED_FIFO与SCHED_RR是实时调度策略。


完全公平调度(CFS) 
-----------------

目标延迟 - 无限小的调度周期
------------------------
目标延迟可以是20ms.

最小粒度 - 因为当进程数越多，在一个调度周期内， 每一个进程的时间片趋于零。
--------------------------------------------------------------
最小粒度为1ms.

处理器使用比
-----------

nice值 - 映射到每一个进程的处理器使用比， 值越大， 比值越小。
----------------------------------------------------

nice值对应作为进程获取处理器的运行权重。例如， 

* 进程A的 nice为0， 运行时间为a;
* 进程B的 nice为5, 运行时间为1/3a;

如果只有以上两个进程， 则进程A所持有的时间片为 (20ms / (a + 1/3a)) * a = 15ms, 进程B所持有的时间片为 (20ms / (a + 1/3a)) * 1/3a = 5ms.




时间记账
-------

进程选择
-------

调度器入口
--------

睡眠与唤醒
---------

















