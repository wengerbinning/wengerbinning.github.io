计算机网络是指两台或多台计算机通过传输介质和通信设备互相连接起来，在遵循约定的通信规则下有效的交换数
据的系统。在这里我们将依次了解网络（在这部篇文章中，我们将计算机网络简称为网络）的模型、分类、体系结
构、服务类型以及参考模型。计算机网络在发展的过程中出现了从简单到复杂的四种模型：主机/终端模型、对等
模型、客户端/服务器模型以及浏览器/服务器模型。在网络的划分中，根据拓扑结构可以划分为星型、总线型、环
型、树型以及网型，具体的网络不能归属特定的拓扑结构中，而是由多种拓扑结构组成；根据地理范围划分为个人
网、局域网、城域网以及广域网，因特网是世界上最大的广域网；在网络的体系结构中，因为网络发展的愈发复杂，
所以采用分层的思想，下层为上层提供服务，对等体按照协议进行通信；在网络服务中，可以分为面向连接的服务
与无连接的服务；整个网络分层思想中，存在OSI与TCP/IP两个参考模型，一般按照TCP/IP模型。接下来，将详
细说明各个内容。

计算机网络模型
-----------

在上面，我们已经说明在网络的发展史中出现了四种模型，分别是主机/终端模型、对等模型、客户端/服务器模型
以及浏览器/服务器模型。其中在客户端/服务器模型与浏览器/服务器模型中，服务器可以分为网站服务器与数据库
服务器。

**主机/终端模型**

在计算机问世初期，因生产技术的限制且价格昂贵，只有少数机构才能配置且大部分人不能直接使用；为了让计算
为更多人服务，出现终端(Terminal)，这仅是一个输入输出设备；每一个计算机连接多个终端，这样可以有多个
用户通过各自的终端来与计算机交互，计算机根据终端传递的数据来执行不同的任务。准确来说，这个模型不能称
为计算机网络，但是因为这个可以视为网络的雏形，所以将它作为最简单的网络模型。

**对等模型**

对等(Peer-to-peer)模型是将计算机通过传输介质直接连接的网络模型，在该模型中所有的计算机属于平等的，
既可以提供服务也可以使用服务。

**客户端/服务器模型**

客户端/服务器(C/S, Client/Server)模型，也称作胖客户端(Fat client)模型。该模型的出现是因为网络
资源一般存在少数计算机中，将这类计算机称为服务器，可以实现对资源有效管理，对外提供服务，其他使用服务
的计算机被称为客户端。在这个模型中，一般都是客户端中服务器获取数据，在处理之后将结果返回给服务器。

**浏览器/服务器模型**

浏览器/服务器(B/S, Browser/Server)模型，也称作瘦客户端(Thin Client)模型。

计算机网络的分类
-------------

首先按照拓扑结构来分类，不过需要说明的是现实中网络不能归类到某一具体的拓扑结构，而是有多个拓扑结构组
成的。

**星型网络**

**总线型网络**

**环型网络**

**树型网络**

**网型网络**

---

然后按照地理范围划分网络

**个人网**

**局域网**

**城域网**

**广域网**


计算机网络的体系结构
----------------

随着网络的发展，其体系结构越来越复杂，因而采用分层的思想来降低复杂度，每一层都实现若干的特定功能和任
务；







### 计算机网络的分类

一般  格局网络的规模将计算机网络分为LAN(Local Area Network, 局域网)、MAN(Metropolitan Area Network, 城域网)、WAN(Wide Area Network, 广域网)与Internet,其中LAN最大不超过10KM的覆盖范围,但传输速率很高;MAN最大覆盖范围不超过100KM;WAN的覆盖范围一般超过100KM

### 网络的连接策略

在选择网络策略时需要对网络进行需求分析:组网用户数量、网络服务、用户的分布、网络的传输速率、扩展需求以及经费;根据以上需求可以分别选择以下连接策略.

* P2P(Peer-to-peer Network,对等网): 提供一种简单、低廉的个人互联策略,各计算机之间是平等的,既是访问者又是资源提供者,但具有备份困难、管理不便等缺点;
* C/S(Client-Server Network, 客户机与服务器网络): 提供组件大型网络的能力,向用户提供大量的资源和网络服务;客户机是使用服务器所提供服务的计算机;服务器是具有较高计算能力,多用户的计算机,提供诸如FTP、Email、Database等服务;一般配备专职的网络管理员,负责服务器的管理工作;具有资源可集中管理的优点,但通常成本较高;
* B/S(brower-Server Network, 浏览器与服务器网络):

## 网络的传输媒介

传输媒介是计算机网络中的重要组成部分,是信息数据运输的通道根据网络传输的性能要求与传输距离可选择不同的传输方式.

* 有限传输媒介: 主要有双绞线、同轴电缆、光缆等;

  * 双绞线有UTP(非屏蔽双绞线)与STP(屏蔽双绞线)两大类,其中UTP-5(5类非屏蔽双绞线,通产包括4对双绞线,通过RJ-45连接器连接)是目前局域网中管广泛使用的传输介质,其最高数据传输速率为100Mbps;
  * 同轴电缆根据直径可分为细缆与粗缆,根据电缆的阻抗分为50Ω与75Ω的同轴电缆;中心铜芯以导电性能良好的铜材料制造,可以传输高频交变电流承载的信息;外层铜对内层通道起屏蔽干扰的作用;同轴电缆可以传输数字或模拟信息;

    * 50Ω同轴电缆的传输速率上限可达50Mbps,一般为10Mbps;
    * 75Ω同轴电缆是公用天线电视系统中的标准传输电缆,一般用于模拟传输系统;
  
  * 光纤: 由若干条光导纤维作为芯线加上防护外皮而做成的传输媒介,光纤通常由石英玻璃拉成细丝(8~100μm),具有传输频带宽,通信容量大的特点;

在缆线与计算机之间需要连接器,其中双绞线常用RJ-11、RJ-45连接器,同轴电缆使用的时BNC连接器,光纤上使用的时光纤尾线接头.

网络接口适配器(网卡)用于计算机和网络传输传输介质,在安装好驱动后,网卡才能正常工作.

* 无线传输介质: 例如微波、红外线、无线电波、激光;

  * 微波通信又地面微波通信与卫星微波通信,通过中继站,可以实现远距离传播信号,常用于电视信号,携带电话等无线通信的设备;
  * 红外通信级数利用红外线来传输数据,设备简单且易于实现,广泛用于小型移动设备交互数据与控制中;
  * 蓝牙是以无线电波作为传输介质的一种级数标准;
  * FSO(Free Space Optics,无线光通信技术)是利用激光束作为信道在空间直接进行语音、数据和图像信息的双向传输的技术

* 网络中的连接设备:中继器、集线器、交换机、路由器;

  * 中继器: 接受网络传输介质中的数据信号,复制再生这些信号,确保信号能正确地继续传输,保持了数据信号的完整性;
  * 集线器: HUB上的每一个端口可以连接一台计算机,局域网中的计算机通过它来交换信息,通常被用作局域网中的连接设备,作为局域网的中心连接点,是一种共享传输介质的设备,所有传到集线器的数据均被广播到所有端口,选用集线器作为连接设备是组件一个小型局域网比较经济的方案;
  * 交换机: 交换机接收与存储某端口上的数据包,经过处理后,将数据包传送到目的端口,而不是广播,交换机间的距离一般不超过100m,分为接入层、汇聚层;
  * 路由器: 实现不同网络之间互联,综合使用了硬件与软件,将数据从源网络路由到目的网络即为数据,从源网络到目的网络的一条该走的道路;也可以被用来将非常庞大,数据拥塞的局域网进行划分,亦可以利用不同的广域网技术连接远程的网络;

* 网络的拓扑结构: 即为网络设备之间的连接方式,是一种网络的简化描述,主要的网络拓扑结构有总线形结构、星形结构、环形结构、网络形结构；

  * 总线形结构: 采用总线作为公共的传输通道,所有的节点都通过相应的硬件接口直接连接到总线,总线两端安装了终结器;
  * 星形结构: 要求网络有中央节点(集线器或交换机),网络中的所有端节点都有各自的专用线路接入中央节点,形成辐射形网络结构,各节点须通过中央节点相互通信;
  * 环形结构: 指在网络中的各节点通过环路接口连接在一条首尾相接的闭合环形通信线路中;
  * 网络形结构: 最一般化的网络结构,任何一个节点至少有两条链路与其他节点连接,这种网络被称为分布式网络,是大型网络的基本结构;

* 通信信号: 在通信的过程中,信息的传递是通过发送信号实现的;
* 调制解调器MODEM(俗称的"猫"): 一种信号变换器,包含ADC与DAC; **ADSL原理**
* 信道的带宽: 信道是通信双方之间以传输介质为基础传递信号的通络,由传输介质及其两端的信道设备共同组成,传输介质承载一个或多个通信信道,带宽(bandwidth)是指通信信道的传输容量

* 信息交互方式: 传统电话与IP电话;

## 网络协议

网络协议的分析方法： FSM（finite-state machine）
通信双方所共同遵循的规则称为协议,协议实际上是一组指挥行为的准则,在网络上两台计算机之间交换信息也有一些规则和约定,称为网络协议,为了保证能够正确传输数据,发送和接受数据的计算机都必须遵守协议,以确保发送和接受数据有序和准确,每一个网络中至少要选择一种网络协议.网络中的计算机将遵循网络设计者所选择的协议进行通信.选择那种通信协议取决于网络的规模、网络的兼容性和网络管理等内容;局域网与广域网所采用的协议是不同的,在局域网中一般采用NETBEUI、IPX/SPX和TCP/IP三种协议中一种.

* NETBEUI: 高效、快捷、安装简单、不具备跨网段功能,由几到百台PC组成的小型局域网,支持Windows平台;
* IPX/SPX: 在复杂网络环境下适应性强,可跨网段,具有路由功能,安装无需配置,适合Novell网络使用,支持Netware,无法在Windows上直接使用;
* TCP/IP: 安装时需要复杂的设置,支持任意规模的网络,支持所有平台,接入因特网的主流协议;
* 在网络中,handshake(握手)指两台计算机之间作出的约定;

### OSI模型

ISO(International Organization for Stabdardization,国际化标准组织)为解决不同的网络之间进行通信的问题,提出了
OSI/RM模型(The Reference Model of Open Systems Interconnection,开放系统互连参考模型)将通信所必需的功能分为
七个层次(从高到低):**应用层**、**表示层**、**会话层**、**传输层**、**网络层**、**数据链路层**、**物理层**,使网
络部件能够标准化,模块化,各层功能相对独立,易于研发,维护和理解,为复杂的硬件和协议组件的关系提供一个简单的解释,由于OSI
标准的复杂性,所以未能普及,所以大都以OSI层次模型作为出发点;



### TCP/IP

TCP/IP(传输控制协议/网络协议)在OSI参考模型出现前十年就存在,TCP/IP协议以及其他一百多个协议构成了TCP/IP协议簇,TCP/IP的应用层定义了面向应用的协议,网络应用都要依赖于这些不同的应用协议;

* 传输层有两个并列的协议TCP(传输控制协议)与UDP(用户数据报协议);

  * TCP是一个面向连接的协议,提供了高可靠性服务,用于一次传输要交换大量报文的情形,如远程登录,文件传输;
  * UDP提供的是高效率服务,用于一次传输交换少量保温,如即时消息通信的ICQ与0ICQ和网络数据库查询等情形;

为了标识TCP/或UDP协议与应用层协议的对应关系,TCP/UDP提出了协议端口的概念,端口是TCP和UDP与应用程序打交道的访问点.

网络层的IP协议是一个不可靠的无连接协议,提供将一个数据报从一台计算机或设备传送到另一台计算机或设备的方法以及网络寻址的方法;0

## 组网步骤

当只有一台计算机时，不需要组网；当有多台计算机需要通信时，此时需要通过网线等实现计算机网卡间
的两两连接，由于两两连接需要耗费大量的网线资源且不便于扩展，此时出现了集线器，及将一个端口上的
数据广播到其他端口上去，此时只需要将计算机连接到集线器就可以实现与该集线器上的其他计算机进行
通信，由于集线器是将数据广播出去的，所以需要在每个计算机的网卡上实现对数据的识别:MAC地址是计
算机出厂后固定的，所以通过数据携带的目的MAC,可以知道该数据是否是其他计算机发送给本计算机的，
如果是则接收，否则丢弃；由于集线器会将所有数据广播，所以实质是所有计算机都能收到发送的数据，此
时在集线器中的非通信的计算机会处理不必要的数据；

此时出现了交换机：可以根据收到的数据，发送到指定的的计算机，该功能是通过交换机中存储的MAC表
（计算机的MAC地址与连接到交换机的物理端口的对应表）来实现的，当收到数据时，会在MAC表中查找数
据目的MAC地址对应的端口并发送出去，如果不存在， 则将数据广播出去，除此之外，交换机还会检查数
据源MAC地址是否在MAC表中，不存在时添加到MAC表中；在交换机组成的网络中，可以通过串联来暂时解
决端口不足的问题，此时，每一个交换机的MAC表会记录所有连接到网络的计算机，随着计算机的增长，
MAC表会变的很很庞大。

此时又出现了路由器，路由器的每一个端口都有MAC地址，因为MAC地址为固定的，不便于动态扩展，所以
需要IP地址，并且有子网掩码与默认路由，当计算机通过网卡发送数据时会根据当前网卡的子网掩码计算
目的IP地址网络号，如果与本网卡相同，则直接发送出去，否则发送给默认路由，默认路由一般是路由器
的IP地址，与发送数据的计算机处于同一个子网中，当路由器接收到数据后，会根据路由表（网络号或IP
地址对应的MAC地址）来选择将数据发送到指定的MAC地址的物理接口上。

计算机在同一网段通信时需要根据ARP协议来生成路由表，来查找指定IP对应的MAC地址。

议根据IP地址来获取对应的MAC地址。
来判断


* 确定组网方案,绘制网络拓扑图;
* 计算机操作系统的安装与配置;
* 硬件的准备与安装;
* 网络协议的选择与安装;
* 授权网络资源共享;

## 因特网的接入

因特网是世界上最大的国际性互联网络

* 接入因特网的技术手段:

  * 普通MODEM拨号接入;
  * ISDN拨号接入;
  * ADSL虚拟拨号接入;
  * Cable Modem接入;
  * DDN专线接入;
  * 光纤接入;
  * 无线接入;因特网的协议制定者: NSF, ISOC, IAB, IEIF, IESG
  * 局域网接入;

  <!-- 中国互联网络信息中心 CINIC http://www.cinic,net -->
  <!-- 因特网的协议制定者: NSF, ISOC, IAB, IEIF, IESG -->
  <!-- ICP, ASP ISP -->

## IP地址及其管理

IPv4(IP协议的第4版本),由32为二进制数表示,其中每八位可以用十进制的0~255来表示,其中IP地址由网络号与主机号组成,并由子网掩码区分;

* IP地址的分类:

  * A类: IP地址的前8位二进制是网络号,其余为主机号;
  * B类: IP地址的前16为二进制是网络号,其余为主机号;
  * C类: IP地址的前24位二进制是网络号,其余位主机号;
  * D类: 组播地址;
  * E类: 保留地址;

子网掩码是划分IP地址的网络号与主机号的;

<!-- IANA,因特网编号分配管理机构; IR -->

IP地址分配机构分为三级:IANA,地区级,本地级

DHCP,动态主机分配协议;

IPv6(IP协议的第六版本),由128位二进制组成,每十六位为一组,由4位十六进制表示,并以:分割;

域名与域名系统: 域名解析
域名格式: 主机名.机构名.网络名.地区域或地域域名

* 域名类别:

  * 以行业分类:

    * `.com`: 商业域名;
    * `.edu`: 教育机构;
    * `.gov`: 政府机构;
    * `.mil`: 军事部门;
    * `.org`: 民间团体或组织;
    * `.net`: 网络服务机构;

  * 以国家分类:

    * `.cn`: 中国;
    * `.jp`: 日本;
    * `.au`: 澳大利亚;
    * `.hk`: 中国香港;

服务器根据计算能力可分为工作组级、部门级、企业级服务器.

### 互联网的访问

数据帧: 由数据包+IP头+MAC地址,MAC地址在路由跳转中不断更新,指定下一条的地址,IP指定目的地;

* OSI参考模型(七层): 每一层对上一层提供服务;

  1. 应用层: 所有能够产生网络流量的程序;
  2. 表示层: 在传输之前进行的压缩与压缩处理以及编码处理;
  3. 会话层: 使用`netstat -n`或`netstat -nb`查看会话层的连接;
  4. 传输层: 可靠传输,流量控制,不可靠传输;
  5. 网络层: 确定最佳路径以及IP地址管理;使用静态路由可以指定特定的路径通信;
  6. 数据链路层: 定义帧的开始和结束,透明传输,差错校验;
  7. 物理层: 定义了网络设备的接口标准与电器标准;

* 使用OSI模型进行网络排错: 依次检查

  1. 物理层故障: 检查连线问题: 查看连接与数据包状态;
  2. 数据链路层故障: AMC地址冲突,ADSL欠费导致故障,网络带宽不一致，计算机连接错误的LAN;
  3. 网络层故障: 配置错误的IP地址、子网掩码、网关、路由器上没有到达目标网络的路由;
  4. 应用层故障：程序出现的错误;

* OSI参考模型和网络安全:

  1. 物理层的安全: 直接接入网络的接口;
  2. 数据链路层安全: ADSL、WiFi、VLAN、交换机端口绑定；
  3. 网络层安全: 在路由器上使用ACL控制基于IP地址的的访问,防火墙;
  4. 应用层安全: 应用程序的安全;

* TCP/IP协议栈: 将OSI参考模型的会话层、表示层包含到应用层;

  1. 应用层: HTTP、FTP、DNS协议;
  2. 传输层: TCP、UDP协议;
  3. 网络层: ARP、IP、ICMP、IGMP协议;
  4. 数据链路层与物理层: Ethernet、 ATM、 Frame Relay协议;
  5. 物理层:

* 计算机网络的性能指标:

  1. 带宽: 网络设备的数字信道所能传输的最高速率;
  2. 速率(比特率): 每一个信道连接在计算机网络上的主机在数字信道上的传输数据位数的速率;
  3. 吞吐量: 单位时间内通过某个网络的数据量;
  4. 时延: 由发送时延(数据快长度与信道带宽之比)、传播时延、处理时延、排队时延;
  5. 时延带宽积:
  6. RTT(Round-Trip Time,往返时间): 发送到接受的时间;
  7. 网络利用率: 信道利用率,网络利用率;

## OSI参考模型

---

### 物理层

物理层的通信技术就是为上层链路层提供传输数据报文的能力，该通信技术有一个统一的通信系统模型：

> 信源 -> 发送设备 -> 信道（噪声源） -> 接受设备 -> 信宿

在物理层主要解决如何连接各种计算机的传输媒体上传输比特流,制定接口的机械、电气、功能、过程特性标准;即需要了解数据编码、复用技术、交换技术、SDH标准技术、接入网技术，接入网是位于因特网边缘的大量端系统与因特网边缘路由器的最后一段通信线路。

在通信系统模型中，通信的方式有三种：单工（simplex）、半双工（half-duplex）以及双工（duplex）；并且在信道上传输的信号有基带信号与带宽信号；这些信号都是借助传输媒体来进行传递，传输媒体有导向传输媒体与非导向传输媒体之分。

| 传输媒体 | 类型 | 接口 |
|：--- |：--- |：--- |
| 双绞线 | 导向传输媒体 | RJ-45 |
| 光纤 | 导向传输媒体 | 
| 同轴电缆 | 导向传输媒体 | 
| 微波 | 非导向传输媒体 |
| 卫星 | 
| 无线电 | 

* 编码技术：编码技术

* 复用技术： 

* 交换技术：

* 接入网技术：

* 数字传输技术：

### 数据链路层

链路是一条点到点的物理连接，数据链路是除物理连接外，还包括有通信协议来控制这些数据的传输；在数据链路上传输的数据单元是数据帧。其传输方式有两种点到点链路（point-to-point link）与广播链路（broadcast link）。链路层协议需要完成数据成帧（framing）、差错检测（error detection）、可靠交付（reliable delivery）、媒体访问（medium access）、流量控制（flow control）。数据链路层服务主要是在网络适配器（network adapter）实现的，网络适配器也称NIC（Network Interface Card）、网卡，通常与系统的I/O总线相连，在结点内存和网络链路之间传输数据。

#### 数据成帧

在分组交换网络中，结点交换的是数据块；链路层将上层交付的数据报拆分成数据帧的形式来传输。

* HDLC（high-level data link control）协议的数据帧：由8bit的开始序列、16bit的首部、数据荷载、16bitCRC（cyclic redundancy check）、8bit结束序列组成。

  ```mermaid
  graph LR
  A[开始]---B[首部]---C[数据]---D[检验]---E[结束]
  ```

  * 开始与结束序列是固定的01111110，为避免该其他位置出现该序列，需要采用比特填充（bit stuffing）来解决。即HDLC发送方在数据荷载中发出5个连续的1后添加一个0；接收方在检测到5个连续的1后，下一位如果是0：则一定是填充，如果是1：判断下一位为0时，为结束序列，不是则出错了。
  * 首部内容是帧的接收方地址与发送方地址。

* PPP协议的数据帧：由8bit标志、8bit地址、8bit控制、（1~2）bit协议、荷载、（2~4）检验和、8bit标志组成。

  * 标志字段是01111110。
  * 地址字段是11111111。
  * 控制字段是00000011。
  * 协议字段：上层协议的代码。
  * 荷载字段：分组数据最大1500byte。
  * 检验和：

#### 差错检测和纠错

比特的差错检测和纠错是链路层的重要服务。采用CRC、奇偶校验、检验和来检测，采用检错重传（detect and retransmission）与FEC（forward error correction）两种方式来纠错。

#### 可靠数据传输

可靠数据传输是指将物理上不可靠的信道变成逻辑上可靠的信道。实现这种服务的协议称为可靠数据协议（reliable data transfer protocol），这种协议需要实现的机制有：差错检测、接收方确认、重传、定时器、序号。

* SW（stop and wait）协议：发送一个分组就停止发送，以等待接收方发来的确认。
  
  * SW0协议：完成基本的停止等待协议：发送方发送PKT后等待响应，接收方在收到正确的PKT后返回ACK，否则返回NAK，发送方收到ACK，发送下一个PKT，收到NAK重传原PKT。
  * SW1协议：为解决SW0发送方一直等待接收方确认信号引起的**死锁**，在SW0的基础上增加了超时定时器（timeout timer）：在发送方发送完PKT后启动一个超时定时器，如果超过定时的重传时间仍收不到确认信号就重新发送原来的PKT。
  * SW2协议：为解决SW1接收方的ACK丢失时引起的**PKT冗余**，在SW1的基础上增加了发送序号：每发送一个新的PKT就将发送序列加1，接收方收到相同序列的PKT表明重复并丢到冗余的PKT，此时接收方仍需要补发一个ACK；发送序号仅需区别本次的PKT与上次的PKT，所以仅需要1bit的编号。
  * SW3协议：为解决SW2接收方的ACK超时引起的**过早超时**，在SW2的基础上增加了确认序号。SW3这样的可考数据传输协议常称为ARQ（automatic repeat request）：重传的请求是自动进行的。

* 流水线可靠传输协议：一次连续发送多个报文，提高信道的利用率；在使用流水线传输时，需要增加序号的范围来保持数据帧的唯一。在发送端与接收端必须增加缓存机制来保存多余的分组。

  * GBN（go-back-N）协议：通过发送窗口机制来限制发送方连续发送分组的个数，所以也被称为滑动窗口（sliding-window protocol）协议。实在流水线协议的机制上增加了华东窗口机制。

  * SR（selective repeat）协议：通过让发送方进传送那些它怀疑在接收方出错的分组来避免不必要的重传

#### 多路访问

多路访问是协调共享信道的机制。

* 信道划分协议：

  * 时分多路复用：
  * 频分多路复用：
  * 码分多址：

* 轮流协议：

  * 令牌传递协议：
  * 轮询协议：

* 随机接入协议：

  * ALOHA协议：
  * 时隙ALOHA协议：
  * CSMA协议：

### 网络层

网络层是协议栈中最重要和最复杂的层次之一，在学习在层次的知识时，将从异构网络互联、路由选择以及分组转发入手，在这里将会了解路由器的基本工作原理。这些都是网络层的功能。
网络层是利用数据链路层的网络向上层提供链路层服务，提供了将分组从网络的一侧主机传输到网络另一侧的主机的端到端的通信服务。网络层是工作在异构的数据链路层之上。异构网络
的互联方式两两互联、与中立的中继系统互联的方式实现；因特网是采用一种与机器、操作系统、语言无关的中继系统（IP系统）来解决异构网络互联的问题。每一个异构网络负责将自己
的协议映射到IP协议上来；因此IP网络可以看做一种用于互联异构通信网络的虚拟网络。路由器是连接各异构网络的设备；该设备的最高层是网络层。

在网络层将分组从源终端到目的终端传输时，需要两种网络层功能：路由选择与转发，这两种网络层功能是由路由器提供。

* 路由选择是在分组传输前根据路由算法选择分组传输的路由并存储到转发表中的功能；
* 转发是将分组根据转发表实现链路的选择；即决定分组从哪一个链路接口输出；

在分组传输的过程中有直接交付与间接交付两类；

* 直接交付：源主机与目的主机位于同一个链路网络中，源主机直接将数据传输到目的主机。
* 间接交付：源主机与目的主机属于不同的链路网络中，源主机需要将数据经由路由器的传递处理。

网络的服务模型有面向连接服务与无连接服务两种；面向连接服务的网络称为虚电路网络，需要提供确保交付、具有时延上限的确保交付、有序分组交互、确保最小带宽、确保最大时延抖
动以及安全性服务的服务；无连接服务的网络称为数据报网络，只能提供尽力而为的基本服务。

* 虚电路网络：除路由选择与转发的网络功能外，还具有建立连接的功能，该概念来源于电话网。该网络需要经过三个阶段：虚电路建立（信令报文）、数据传输、虚电路拆除。采用信令协议。

* 数据报网络：因特网是一种在网络层采用无连接服务的数据报网络。该网络中传输分组时，需要加上目的端的地址。

因特网的服务模型提供的服务有编制方案与传输数据的无连接数据包模型。因特网网络层有4个组件：IP组件、路由选择与转发组件、地址映射组件以及互联网控制组件。

* 因特网的IP数据分组称为数据报，数据包可以被分组为数据报片，由于存在DOS攻击等分险，分片技术已舍去。

  ```
  IP数据报文格式
  —————————————————————————————————————————————————————————————————————————————————
  0         4         8                   16    19                               31
  ---------------------------------------------------------------------------------
  |  版本号  | 首部长度 |      服务类型       |            数据报长度（2B）             |
  ---------------------------------------------------------------------------------
  |              标识（16bit）             | 标志 |    片偏移（13bit）                | 
  ---------------------------------------------------------------------------------
  |       寿命        |        协议         |          首部检验和                    | 
  ---------------------------------------------------------------------------------
  |                                     源IP地址                                   |
  ---------------------------------------------------------------------------------
  |                                    目的IP地址                                  |
  ---------------------------------------------------------------------------------
  |                                   数据                                        |
  ---------------------------------------------------------------------------------
  ```

网际协议（IP）：因特网中核心协议，包括因特网编址与转发两项功能；IP有IPv4（RFC 791）， IPv6（RFC2373,RFC2460）两个版本。

* IPv4的编制方案有： 分类编址、子网编址以及无类别域间路由选择编址三中方法。

  * 分类编址： 即将IP地址分为ABCDE五类
  * 子网编址： 采用子网掩码的方式进行编址
  * 无类别域间路由选择编址： 采用前缀的方式编码。


* DHCP： 用于动态获取IP

* NET：

* ARP(数据发送之前使用)：通过MAC广播将查询IP地址发送，网络中所有电脑对比自己的ip与接收ip，如果相同，则将自己的MAC告诉发送者，从而解析出IP地址对应的MAC地址。

  * arp欺骗（同一网络中的主机发送另一MAc地址覆盖正确MAC地址）
  * 网络执法官。`arp -s <ip> <MAc>`设置静态路由，或防火墙避免啊日派欺骗。


* 互联网控制报文协议ICMP协议：ping使用的ICMP协议。TTL（windows一般为128，Linux一般为64，Unix一般为255）数据包生存时间，`ping <IP> -i 1`返回与IP网络连接的第一个ip节点.

* IGMP协议：组播协议。

### 传输层

* TCP协议：

* UDP协议：

### 应用层

### 端口

* 系统端口： 0-1023
* 服务端口： 1024-49151
* 客户端口： 49152 - 65535

* HTTP：基于TCP协议与端口80
* FTP
* SSH
* POP3

## 计算机网络dd

### 直接连接的网络

直接连接的网络主要涉及数据链路层的技术。


该部分主要介绍了计算机网络相关的基础内容， 主要以理论知识为基础，其具体应用场景将在其他部分进行说明。

### [计算机网络](network/README.md)

在计算机网络中， 将先说明理论知识， 之后在说明该技术在现实中的应用。

#### 硬件相关

* [网络的传输媒介](network/cable/README.md)

* [网络适配器](network/nic/README.md)

#### 协议相关

协议在实际应用中可能会跨层， 所以我们先单独说明各个协议，之后给出一张表来说明各个协议属于那一层。

* [以太网协议簇](network/ethernet/README.md)

* [IP协议簇](network/ip/README.md)



#### 无线网络

* [Wi-Fi]()

* [Buletooth]()

#### 应用产品

* [集线器]()

* [交换机]()

* [路由器]()

* [接入点]()










当设备准备向另一个设备发起一次请求， 首先会判断是否为同一个网段， 
如果为同一个网段， 直接向目标发起一次ARP请求， ARP请求成功后， 直接目标发送请求

如果为跨网段， 则向默认网关发起一次ARP请求后， ARP请求成功后， 向默认网关发送请求。 
默认网关根据路由处理请求的去向。