编译指令是存在于源码中的特定指令，该指令会由预处理器来进行转化、替换以及设定编译参数。

**宏**

宏是一种别名的机制，在预编译时会由宏值来替换宏名，除此之外不会做任何处理，所以在使用宏时，
需要根据情况使用括号。

```c
#define VERSION 0.0.0.1
```

当然也可以定义宏函数

```c
#define MAX(a, b) { a>b ? a : b }
```

通过一下方式来销毁已定义的宏

```c
#undef DEBUG
```


* `#`的用法：#是将参数转化为字符串，例如在输出参数的变量时，可以这样使用：

```c
#define sum(a,b) printf("%s+%s=%d",#a,#b,a+b)

int main() {
  int suma=1, sumb=2;
  sum(sunma, sunmb);
}
```

> Note: 将会输出`suma+sumb=3`的结果。除了这样使用还有字符串中转化为指定的标识符。例如`printf("number "#x"'s value is %d", x)`。

* `##`的用法：可以前后两个字符进行粘合

```c
#define print(object) object ## print  // 改结果会使用`<object>print`来替换宏。
#define INT(n) int ## n
INT(8)
```

> Note: #或者##在每一次宏定义时只能出现一次。

* 预定义的宏名:
  * \_LINE\_    行号
  * \_FILE\_     名称
  * \_DATA\_    日期
  * \_TIME\_     时间
  * \_STDC\_    是否执行ANSI C标准

**条件编译**

条件编译是根据逻辑条件来控制哪段代码需要被编译，通常调试代码通过DEBUG宏来控制。

```c
#ifdef DEBUG

// TODO: If the DEBUG marco has defined. This source code block will compile.
// Usually the DEBUG marco control is the debugging information of the code.

#endif
```

条件编译通常用在在头文件中来避免被多次引入。

```c
#ifndef __INCLUDE_H__
#define __INCLUDE_H__

// TODO: If the __INCLUDE_H__ marco hasn't defined, it will define and the 
// source code block will compile. Otherwise, strip this source code block.

# endif // __INCLUDE_H__
```

当然除了以上的用法还有一下几种用法。

```c
#ifdef CONFIG_USB_SUPPORT

// TODO:

#else

// TODO:

#endif
```

```c
#ifndef CONFIG_USB_SUPPORT

// TODO:

#else

// TODO:

#endif
```

```c
#if 1

// TODO：

#endif
```

```c
#if 0

// TODO:

#else

// TODO:

#endif
```

**错误信息**

在预处理阶段如果发现逻辑条件不正确，可以通过error来输出一个错误信息并停止编译。

```C
#error "Here has a error, you need deal it."
```

> Note: 输出信息中不能包含宏。

**行号信息**

通过line可以修改编译器默认指定的的文件名与行号信息，该指令之后的行号将为指定的行号值，这
些信息会在警告信息、错误信息、与调试信息中被包含

```C
// 修改 __LINE__ 与 __FILE__ 值 (__LINE__ 与　__FILE＿　是预编译程序中预定义的标识符)
#line <行号值> <当前编译文件名>   
```

**pragma**

通过pragma可以想编译器传递额外的信息, 通常需要一个标记，如果标记是STDC那么就是一个标准的pragma
否则pragma的作用依赖于编译器的版本。

```c
#pragma tokens
```

* 编译指示指令

  * #pragram: 设定编译器的状态,指示编译器完成一些特定的动作

    | 参数     | 说明 |
    | :------- | ---- |
    | message  |      |
    | code_seg |      |
    | once     |      |
    | hdrstop  |      |
    | resource |      |
    | warning  |      |
    | comment  |      |


**_Pragma**

  _Pragma是一个一元操作符，处理方式为：(1.如果字符串具有L前缀，则删除该前缀;(2.删除前导和结尾双引号；(3.用双引号替换每一个换码序列';
  (4.用单个反斜杠替换每一个换码序列\\.

  Pragma较于#pragma的优势是可以用于宏定义。

**attribute**

<https://gcc.gnu.org/onlinedocs/>

<https://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#Function-Attributes>

`__attribute__`用于说明变量、类型、函数等的属性，

```c

__attribute__((packed);
```

**volatile**

* `volatile`提示编译器该修饰词之后的变量随时都有可能改变，因此编译后的程序每次需要存储或读取这个变量，都是直接从
变量地址中读取数据。如果没有volatile,则编译器可能会优化读取与存储：暂时使用寄存器中的值，而不是实际地址中的值。一
般对等待其他程序改变的变量均使用该限定词，以保证数据的实时性。





