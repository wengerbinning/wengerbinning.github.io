01234567890123456789012345678901234567890123456789012345678901234567890123456789

## 基础知识

USB的接口一般有四条线5V、GND、D+、D-。
在计算机的USB接口中在D+与D-处有15K的下拉电阻，因此在没有USB设备接入时为低电平；在USB设备的接
口中在D+或D-处有1.5K的上拉电阻，未接入计算机时为高电平，在接入时将D+或D-拉高，从而同时计算机
有USB设备接入。

USB是主从结构，即所有的通信都是计算机发起的，USB设备没有主动与计算机通信的能力；例如，在USB鼠
标产生数据时，不能通知计算机读数据，只被动等待计算机读取数据。作为USB的主机必须具备USB主机控制
器，该控制器

USB的传输类型有四种：控制传输、批量传输、中断传输、实时传输。其中控制传输是可靠的、有时间的保证
的传输，例如USB设备识别的过程；批量传输是可靠的，但是时间没有保证，例如USB存储设备的数据传输；
中断传输是可靠的实时传输，例如USB鼠标；实时传输是不可靠的实时传输，例如USB摄像头。


## 原理分析

USB在Linux中通过各类描述符来表示。每一个USB设备通过唯一的一个设备描述符来表示；在设备描述符中
包含多个配置描述符，但是在同一时刻只能有一个配置描述符被使用；在配置描述符中包含多个接口描述符，
每一个接口描述符对应一个驱动；在接口描述符中包含多个端点描述符，每一端点就是一个数据通道，其中
端点0为默认的控制传输，除此之外的端点只支持单方向数据通信。

在USB设备接入计算机时，计算机会通过发送请求来获取各个描述符信息
